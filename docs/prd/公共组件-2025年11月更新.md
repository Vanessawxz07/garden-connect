# 公共组件 - 2025年11月更新

> 本文档记录交易链路中复用的公共组件需求，作为后续新游戏拓展专项的基线参考。

---

## 一、组件概述

公共组件是在交易链路各页面中复用的UI组件，确保用户体验一致性和开发效率。

---

## 二、道具选择器组件

### 2.1 组件用途

- 创建交易页：选择Have/Want/NLF道具
- 订单详情页：报价时选择道具
- 筛选器：按道具筛选订单

### 2.2 组件结构

**分类Tab：**
- All / Crops / Pets / Eggs / Gear / Tokens
- 横向滚动（移动端）
- 选中态高亮

**搜索框：**
- 道具名称模糊搜索
- 实时筛选结果
- 清空按钮

**道具列表：**
- 网格布局展示
- 道具图片 + 名称 + Value
- 选中态样式
- 空结果提示

**已选道具区域：**
- 显示已选道具列表
- 每个道具可设置数量
- 删除按钮
- 显示已选总Value

### 2.3 交互逻辑

**选择流程：**
1. 切换分类或搜索
2. 点击道具添加到已选
3. 设置道具数量
4. 可移除已选道具

**数量设置：**
- 数字输入框
- 加减按钮
- 最小值1，最大值根据道具类型

### 2.4 组件API

```typescript
interface ItemSelectorProps {
  mode: 'single' | 'multiple';
  selectedItems: SelectedItem[];
  onSelect: (items: SelectedItem[]) => void;
  excludeItems?: string[]; // 排除的道具ID
  maxItems?: number; // 最多选择数量
}

interface SelectedItem {
  itemId: string;
  quantity: number;
}
```

---

## 三、道具卡片组件

### 3.1 组件用途

- 订单列表：展示Have/Want道具
- 订单详情：展示道具详情
- 道具列表：展示道具信息

### 3.2 卡片变体

**迷你卡片（Mini）：**
- 仅图片
- 悬浮显示名称
- 用于列表紧凑展示

**标准卡片（Standard）：**
- 图片 + 名称
- 数量标识
- Value显示

**详情卡片（Detail）：**
- 大图展示
- 完整名称
- 数量输入
- Value + 分类标签

### 3.3 卡片状态

**默认状态：**
- 正常展示

**选中状态：**
- 边框高亮
- 选中标识

**禁用状态：**
- 灰度显示
- 不可点击

**NLF标识：**
- 特殊边框或角标
- 表示在NLF列表中

### 3.4 组件API

```typescript
interface ItemCardProps {
  item: Item;
  variant: 'mini' | 'standard' | 'detail';
  quantity?: number;
  selected?: boolean;
  disabled?: boolean;
  isNLF?: boolean;
  onClick?: () => void;
  onQuantityChange?: (quantity: number) => void;
}
```

---

## 四、Trade Summary组件

### 4.1 组件用途

- 创建交易页：发布前预览
- 订单详情页：订单信息汇总
- 报价确认：报价前预览

### 4.2 组件结构

**Have区域：**
- 道具列表（迷你卡片）
- 道具总数
- 总Value

**Want区域：**
- 道具列表或"Accept Any Offer"
- 道具总数
- 总Value

**Value对比：**
- Have总Value
- Want总Value
- 差额（正负标识）
- 差额百分比

**NLF区域（可选）：**
- NLF道具列表
- 折叠/展开

### 4.3 组件API

```typescript
interface TradeSummaryProps {
  haveItems: SelectedItem[];
  wantItems: SelectedItem[];
  nlfItems?: SelectedItem[];
  acceptAnyOffer?: boolean;
  showValueComparison?: boolean;
}
```

---

## 五、用户信息组件

### 5.1 组件用途

- 订单卡片：显示发布者
- 订单详情：显示交易对象
- 聊天页：显示聊天对象

### 5.2 组件变体

**头像组件（Avatar）：**
- 用户头像图片
- 在线状态指示点
- 大小变体（sm/md/lg）

**用户名片（UserCard）：**
- 头像
- 用户名
- VIP标识
- 在线状态
- 注册时间
- 交易统计（可选）

**用户行组件（UserRow）：**
- 头像 + 用户名 + 在线状态
- 紧凑布局
- 用于列表项

### 5.3 在线状态

**状态类型：**
- 在线（绿点）
- 离开（黄点）
- 离线（灰点）

**状态判断：**
- 基于最后活跃时间
- 5分钟内：在线
- 30分钟内：离开
- 超过30分钟：离线

### 5.4 组件API

```typescript
interface UserAvatarProps {
  user: User;
  size: 'sm' | 'md' | 'lg';
  showOnlineStatus?: boolean;
}

interface UserCardProps {
  user: User;
  showStats?: boolean;
  showVipBadge?: boolean;
  onClick?: () => void;
}
```

---

## 六、筛选器组件

### 6.1 组件用途

- 订单列表页筛选
- 单道具交易列表页筛选
- 道具列表页筛选

### 6.2 筛选器类型

**分类筛选器：**
- Tab样式
- 单选
- 支持"全部"选项

**范围筛选器：**
- 双输入框（最小-最大）
- 用于Value范围筛选

**开关筛选器：**
- Switch样式
- 用于布尔筛选（如"仅在线"）

**下拉筛选器：**
- Select样式
- 用于排序选项

### 6.3 筛选器布局

**桌面端布局：**
- 横向排列
- 展开显示所有筛选项

**移动端布局：**
- 收起为按钮
- 点击打开筛选抽屉
- 底部固定"应用"按钮

### 6.4 组件API

```typescript
interface FilterBarProps {
  filters: FilterConfig[];
  values: FilterValues;
  onChange: (values: FilterValues) => void;
  onReset?: () => void;
}

interface FilterConfig {
  key: string;
  type: 'category' | 'range' | 'switch' | 'select';
  label: string;
  options?: Option[];
}
```

---

## 七、弹窗组件

### 7.1 确认弹窗

**用途：**
- 删除确认
- 取消订单确认
- 重要操作确认

**结构：**
- 标题
- 内容描述
- 取消按钮
- 确认按钮（警告色）

### 7.2 报价弹窗

**用途：**
- 快速报价
- 不跳转页面

**结构：**
- 订单摘要
- 道具选择器
- 备注输入
- 提交按钮

### 7.3 分享弹窗

**用途：**
- 订单分享
- 道具分享

**结构：**
- 分享预览
- 复制链接按钮
- 社交媒体分享按钮

### 7.4 弹窗通用规范

**交互：**
- ESC关闭
- 点击遮罩关闭（可配置）
- 动画过渡

**响应式：**
- 桌面端：居中弹窗
- 移动端：底部抽屉

---

## 八、空状态组件

### 8.1 组件用途

- 列表为空时显示
- 搜索无结果时显示
- 数据加载失败时显示

### 8.2 空状态类型

**无数据：**
- 插图
- 主文案
- 副文案
- 操作按钮（可选）

**无搜索结果：**
- 搜索相关插图
- 提示调整搜索条件
- 清除筛选按钮

**加载失败：**
- 错误插图
- 错误描述
- 重试按钮

### 8.3 组件API

```typescript
interface EmptyStateProps {
  type: 'no-data' | 'no-results' | 'error';
  title: string;
  description?: string;
  action?: {
    label: string;
    onClick: () => void;
  };
}
```

---

## 九、加载状态组件

### 9.1 骨架屏

**用途：**
- 首屏加载占位
- 分页加载占位

**变体：**
- 列表骨架屏
- 卡片骨架屏
- 详情骨架屏

### 9.2 加载指示器

**用途：**
- 操作进行中
- 数据刷新中

**样式：**
- Spinner旋转
- 进度条（有进度时）

### 9.3 加载更多

**用途：**
- 列表底部加载

**样式：**
- "Load More"按钮
- 加载中Spinner
- "No more data"提示

---

## 十、Toast通知组件

### 10.1 通知类型

**成功通知：**
- 绿色主题
- 成功图标
- 自动消失（3秒）

**错误通知：**
- 红色主题
- 错误图标
- 手动关闭或5秒消失

**警告通知：**
- 黄色主题
- 警告图标
- 自动消失（4秒）

**信息通知：**
- 蓝色主题
- 信息图标
- 自动消失（3秒）

### 10.2 通知位置

- 桌面端：右上角
- 移动端：顶部居中

### 10.3 通知队列

- 最多同时显示3个
- 新通知从上方入场
- 旧通知从下方出场

---

## 十一、样式规范

### 11.1 颜色使用

- 使用设计系统的语义化颜色变量
- 不直接使用色值
- 支持深色模式

### 11.2 间距规范

- 使用Tailwind间距类
- 组件内部间距统一
- 响应式间距调整

### 11.3 动画规范

- 使用统一的动画时长
- 过渡效果一致
- 考虑减弱动画偏好

### 11.4 响应式规范

- 移动优先设计
- 断点：sm(640) md(768) lg(1024) xl(1280)
- 组件自适应不同尺寸
